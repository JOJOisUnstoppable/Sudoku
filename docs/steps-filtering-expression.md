# 技巧搜索表达式

技巧搜索表达式是指，在窗体程序之中，我们提供了一个功能，为了尽快找到合适的结果，我们可以在文本框里输入一定的表达式，来找到当前盘面存在的所有满足表达式的技巧。

## 判别关键字

判别关键字是表达式里固定存在的单词，它专门用于固定判断某种东西。目前支持的判别关键字有：

* `rating`：判别难度系数。该关键字代表一个小数，你需要将其用于大小比较。
* `name`：判别名字。该关键字代表一个技巧名称，你需要将其用于字符串的比较规则。搜索表达式需要使用单引号（即 `'字符串内容'`）来表示一个名字。
  
* `conclusion`：判别结论。该关键字代表某个步骤的结论信息，你需要将其用于结论序列和单元格、候选数等字符串表现出来的信息的比较。搜索表达式需要使用单引号（即 `'字符串内容'`）来表示一个单元格、候选数。


使用例子：

* `difficulty >= 3`：表示搜索难度系数大于或等于 3 的技巧；
* `name = '欠一数对'`：表示搜索的技巧名称必须是“欠一数对”技巧。
* `conclusion has 'r3c4'`：表示结论序列里是否包含 r3c4 单元格的结论（不论出数还是删数均可）

## 逻辑关键字

表达式语法使用的是类似编程的判别表达式语法，需要用到三个关键字：`and`、`or` 和 `not`。其中：

* `and`：用于连接两个判别表达式，表示两个表达式**必须同时成立**；
* `or`：用于连接两个判别表达式，表示两个表达式**只需要满足至少一个**；
* `not`：用于配在判别式的左侧，表示对该条件取反。

使用例子：

* `difficulty >= 3 and difficulty <= 5`：表示搜索的技巧，它的难度系数必须在 3 到 5 之间（包含两侧边界）。

另外，你也可以使用编程惯用的符号 `&&` 来表示 `and`、`||` 来表示 `or`、`!` 来表示 `not` 的等价含义。比如 `difficulty >= 3 && difficulty <= 5`。

## 处理规则关键字

除了前面的固定用法外，还有一些类似数学符号的处理逻辑。

### `like` 关键字

`like` 函数需要两个数据参与计算，表示技巧的名字是否匹配固定的模式。举个例子，我想找到带有“唯一矩形”四个字的技巧，我们可以使用如下的写法来取出：

```sql
name like 'unique\s+rectangle.*'
```

在 `like` 左边是匹配的关键字，比如前面提到的 `name`。它代替了我们匹配的内容是技巧的名称；而 `like` 之后写的是匹配模式。这个模式语法是这样的：

* `\s`：表示匹配一个空格；
* `\w`：表示匹配一个字母（包含所有大写和小写）、数字 0 到 9 以及下划线 `_` 符号；
* `\d`：表示匹配一个数字 0 到 9；
* `.`：表示匹配任何不是空格的符号信息（甚至包含中文汉字、括号等等没有前面提到过的符号信息）。

并且，还使用一些符号来参与次数匹配规则：

* `+`：表示该符号左边的内容至少需要出现一次；
* `*`：表示该符号左边的内容随便出不出现、出现几次都可以；
* `?`：表示该符号左边的内容要么不出现，要么只能出现一次；
* `{m,n}`：表示该符号左边的内容至少重复出现 `m` 次，最多只能重复出现 `n` 次。

那么，模式 `unique\s+rectangle.*` 就比较好理解了：

* `unique`：匹配字符串固定内容：u、n、i、q、u、e 字母必须顺次出现，其间不能有任何别的东西干扰该内容；
* `\s+`：匹配至少一个空格；
* `rectangle`：匹配字符串固定内容：r、e、c、t、a、n、g、l、e 字母必须顺次出现；
* `.*`：匹配其它任何东西，该部分可有可无，也不存在出现几次的约定。

所以，满足条件的可以是：

* unique rectangle type 1
* unique rectangle external type 3
* unique rectangle + Sue de Coq

这些技巧名称。不能满足的字符串比如：

* alternating inference chain
* extended rectangle
* avoidable rectangle

注意，匹配规则**不限制大小写**。换句话说，即使你写的小写字母，它对应的大写也可以正确匹配；反之亦然。

### `has` 关键字

`has` 关键字专门用于匹配结论信息。`has` 运算符表示的是，结论信息里包含什么样的数据。支持的判别可以是单元格或候选数、数值等。

#### `conclusion has '单元格'`

当需要判断结论是否包含某单元格的时候，可使用 `conclusion has '单元格'` 的方法来判断。单引号不能少。

#### `conclusion has '候选数'`

当需要判断结论是否包含某候选数的时候，可使用 `conclusion has '候选数'` 的方法判断。注意，书写候选数的格式是 `r2c3(4)` 这样的写法，即带有一个小括号表示候选数的数值。单引号不能少。

#### `conclusion has '=='` 和 `conclusion has '<>'`

如果你要确定结果包含出数结论，或删数结论，可使用 `has '=='` 和 `has '<>'` 来判断。`has` 的底层是字符串匹配，而等号和不等号在字符串里是这么书写的，所以可使用这个写法来判别。

#### `conclusion has '(数字)'`

如果判断结论是否包含某数字，可使用 `'(数字)'` 写法来表示，比如 `conclusion has '(3)'` 表示判断结论里是否包含数字 3 的结论。

### `count` 关键字

`count` 关键字是单目运算，取的是结论的个数。如果需要判断结论数量，可使用 `count conclusion` 来判断。比如 `count conclusion >= 2` 可表示某步骤的结论至少包含 2 个。